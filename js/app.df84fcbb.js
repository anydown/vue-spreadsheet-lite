webpackJsonp([1],{"/UQN":function(t,e){},0:function(t,e,i){t.exports=i("NHnr")},CXbu:function(t,e){},NHnr:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("/5sW"),s=(i("mJx5"),i("rzQm")),o=i.n(s),c=(i("/UQN"),{name:"SushiGrid",props:{header:Array,data:Array},data:function(){return{selection:{c:0,r:0,sc:0,sr:0},editingText:"",editing:!1,rowHeight:24,selectionMode:!1,selectionModeColumn:!1,headerResizeAt:-1}},computed:{editorStyleObj:function(){return{left:this.positionLeft(this.selection.c)+"px",top:24*this.selection.r+"px"}},selectionTransform:function(){return"translate(".concat(this.positionLeft(this.selectionCount.c),",  ").concat(24*this.selectionCount.r,")")},selectionCount:function(){return{r:this.selection.r<=this.selection.sr?this.selection.r:this.selection.sr,c:this.selection.c<=this.selection.sc?this.selection.c:this.selection.sc,w:Math.abs(this.selection.sc-this.selection.c)+1,h:Math.abs(this.selection.sr-this.selection.r)+1}},selectionSize:function(){return{r:this.positionLeft(this.selectionCount.r),c:this.positionLeft(this.selectionCount.c),w:this.positionLeft(this.selectionCount.c+this.selectionCount.w)-this.positionLeft(this.selectionCount.c),h:this.positionLeft(this.selectionCount.c+this.selectionCount.h)-this.positionLeft(this.selectionCount.c)}},headerObj:function(){return this.header?this.header:this.data[0].map(function(t,e){return{name:String.fromCharCode(65+e),width:80}})}},methods:{startColumnSelect:function(t){this.selection.sr=this.data.length-1,this.selection.r=0,this.selection.sc=t,this.selection.c=t,this.selectionModeColumn=!0},changeColumnSelect:function(t){this.selectionModeColumn&&(this.selection.c=t)},endColumnSelect:function(){this.selectionModeColumn=!1},headerResizeStart:function(t){this.headerResizeAt=t},headerResizeEnd:function(){this.headerResizeAt=-1},headerResizeMove:function(t){var e=t.target.parentNode.parentNode.getBoundingClientRect(),i=t.clientX-e.left;if(this.headerResizeAt>=0){var n=i-this.positionLeft(this.headerResizeAt);this.headerObj[this.headerResizeAt].width=n>30?n:30}},widthAt:function(t){return this.headerObj[t].width},positionLeft:function(t){return this.headerObj.slice(0,t).map(function(t){return t.width}).reduce(function(t,e){return t+e},0)},setDataAt:function(t,e,i){n["a"].set(this.data[e],t,i),this.$emit("update",this.data)},getDataAt:function(t,e){return this.data[e][t]},onBlur:function(){this.editing=!1,this.setDataAt(this.selection.c,this.selection.r,this.editingText)},translateCol:function(t){return"translate(".concat(this.positionLeft(t),", 0)")},translateRow:function(t){return"translate(0, ".concat(24*t,")")},onMouseDownCell:function(t,e){this.editing&&this.onBlur(),this.selectionCount.c!==t||this.selectionCount.r!==e||1!==this.selectionCount.w||1!==this.selectionCount.h?this.setSelectionStart(t,e):this.editHere()},setSelectionSingle:function(t,e){this.selection.c=t,this.selection.r=e,this.selection.sc=t,this.selection.sr=e,this.setEditingText()},setSelectionStart:function(t,e){this.setSelectionSingle(t,e),this.selectionMode=!0},onMouseMoveCell:function(t,e){this.selectionMode&&this.setSelectionEnd(t,e)},onMouseUpSvg:function(){this.endSelection(),this.headerResizeEnd()},setSelectionEnd:function(t,e){this.selectionMode&&(this.selection.c=t,this.selection.r=e,this.setEditingText())},endSelection:function(){this.selectionMode=!1},editCell:function(t,e){var i=this;this.editing=!0,n["a"].nextTick(function(){i.$refs.hiddenInput.focus()})},editHere:function(){this.editCell(this.selection.c,this.selection.r)},clearCell:function(t,e){this.setDataAt(t,e,"")},clearSelection:function(){for(var t=0;t<this.selectionCount.h;t++)for(var e=0;e<this.selectionCount.w;e++)this.clearCell(this.selectionCount.c+e,this.selectionCount.r+t)},isInsideTable:function(t,e){return!(t<0)&&(!(e<0)&&(!(t>this.data[0].length-1)&&!(e>this.data.length-1)))},moveCursor:function(t,e){if(this.isInsideTable(this.selection.c+t,this.selection.r+e)){if(this.selectionMode)return this.setSelectionEnd(this.selection.c+t,this.selection.r+e),void this.fixScroll();this.editing&&this.onBlur(),this.setSelectionSingle(this.selection.c+t,this.selection.r+e),this.fixScroll()}},moveInputCaretToEnd:function(){var t=this.$refs["hiddenInput"];t.setSelectionRange(this.editingText.length,this.editingText.length)},fixScroll:function(){var t=this.$refs["wrapper"];t.scrollTop>24*this.selection.r&&(t.scrollTop=24*this.selection.r),t.scrollTop<24*this.selection.r-t.clientHeight+24&&(t.scrollTop=24*this.selection.r-t.clientHeight+24),t.scrollLeft<this.positionLeft(this.selection.c)-t.clientWidth&&(t.scrollLeft=this.positionLeft(this.selection.c))},setEditingText:function(){this.editingText=this.getDataAt(this.selection.c,this.selection.r)}},mounted:function(){var t=this;this.editingText=this.getDataAt(0,0),this.onBlur(),this.$el.onkeydown=function(e){switch(e.keyCode){case 8:t.editing||(t.moveInputCaretToEnd(),t.editHere());break;case 37:t.moveCursor(-1,0),e.preventDefault();break;case 38:t.moveCursor(0,-1),e.preventDefault();break;case 39:t.moveCursor(1,0),e.preventDefault();break;case 40:t.moveCursor(0,1),e.preventDefault();break;case 46:t.clearSelection();break;case 13:t.moveCursor(0,1);break;case 16:t.setSelectionStart(t.selection.c,t.selection.r);break;case 91:break;case 113:t.editing||(t.moveInputCaretToEnd(),t.editHere());break;default:t.editing||(t.editingText="",t.editHere());break}},this.$el.onkeyup=function(e){switch(e.keyCode){case 16:t.endSelection();break}}}}),r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"grid",on:{mouseup:function(e){t.onMouseUpSvg()},mousemove:t.headerResizeMove}},[i("svg",{attrs:{width:t.positionLeft(t.data.length+1),height:"24"}},t._l(t.headerObj,function(e,n){return i("g",{key:n,attrs:{transform:t.translateCol(n)},on:{mousedown:function(e){t.startColumnSelect(n)},mousemove:function(e){t.changeColumnSelect(n)},mouseup:t.endColumnSelect}},[i("rect",{staticClass:"col-header",attrs:{x:"0",y:"0",width:t.widthAt(n),height:t.rowHeight}}),i("text",{staticClass:"col-header__text",attrs:{"text-anchor":"middle",x:t.widthAt(n)/2,y:"12",width:t.widthAt(n),height:t.rowHeight}},[t._v(t._s(e.name))]),i("rect",{staticClass:"col-header__resize",class:{active:n===t.headerResizeAt},attrs:{x:t.widthAt(n)-5,y:0,width:5,height:t.rowHeight},on:{mousedown:function(e){t.headerResizeStart(n)}}})])})),i("div",{ref:"wrapper",staticStyle:{height:"400px",overflow:"scroll",position:"relative"}},[i("svg",{attrs:{width:t.positionLeft(t.data.length+1),height:24*t.data.length}},[t._l(t.data,function(e,n){return i("g",{key:n,attrs:{transform:t.translateRow(n)}},t._l(e,function(e,s){return i("g",{key:s,attrs:{transform:t.translateCol(s)},on:{mousedown:function(e){t.onMouseDownCell(s,n)},mousemove:function(e){t.onMouseMoveCell(s,n)}}},[i("rect",{attrs:{x:"0",y:"0",width:t.widthAt(s),height:t.rowHeight}}),i("text",{attrs:{x:"2",y:"12",width:t.widthAt(s),height:t.rowHeight}},[t._v(t._s(e))])])}))}),i("rect",{staticClass:"selection",attrs:{transform:t.selectionTransform,x:"0",y:"0",width:t.selectionSize.w,height:t.selectionCount.h*t.rowHeight}})],2),i("div",{staticClass:"editor__frame",style:t.editorStyleObj},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.editingText,expression:"editingText"}],ref:"hiddenInput",staticClass:"editor__textarea",class:{"editor--visible":t.editing},attrs:{autofocus:""},domProps:{value:t.editingText},on:{mousedown:function(e){t.onMouseDownCell(t.selection.c,t.selection.r)},blur:t.onBlur,input:function(e){e.target.composing||(t.editingText=e.target.value)}}})])])])},a=[],l=i("XyMi");function h(t){i("PwaL")}var u=!1,d=h,f="data-v-b83495f0",p=null,g=Object(l["a"])(c,r,a,u,d,f,p),m=g.exports,C=o()(Array(20).keys()).map(function(t){return"A".concat(t," B").concat(t," C").concat(t," D").concat(t)}).join("\n"),v={name:"app",components:{SushiGrid:m},computed:{gridData:function(){return this.dataSrc.split("\n").map(function(t){return t.split(" ")})}},methods:{onUpdate:function(t){if(t){var e=t.map(function(t){return t.join(" ")}).join("\n");this.dataSrc=e}}},data:function(){return{dataSrc:C}}},w=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.dataSrc,expression:"dataSrc"}],domProps:{value:t.dataSrc},on:{input:function(e){e.target.composing||(t.dataSrc=e.target.value)}}}),i("div",{staticClass:"right"},[i("sushi-grid",{attrs:{data:t.gridData},on:{update:t.onUpdate}})],1)])},S=[];function x(t){i("CXbu")}var b=!1,T=x,M=null,A=null,y=Object(l["a"])(v,w,S,b,T,M,A),k=y.exports;n["a"].config.productionTip=!1,new n["a"]({render:function(t){return t(k)}}).$mount("#app")},PwaL:function(t,e){}},[0]);
//# sourceMappingURL=app.df84fcbb.js.map